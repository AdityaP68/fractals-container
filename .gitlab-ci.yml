stages:
  - lint
  - test
  - build

# Linting stage
lint:
  stage: lint
  image: bun:latest  # Use the Bun.js Docker image
  script:
    - bun install      # Install dependencies
    - bun run ui:lint  # Run your linting command
  only:
    - main  # Run this job only on the main branch

# Testing stage
test:
  stage: test
  image: bun:latest
  script:
    - bun install      # Install dependencies
    - |
      if bun run ui:test; then
        echo "Tests ran successfully.";
      else
        echo "No test script defined in package.json.";
      fi
  only:
    - main

# Build stage
build:
  stage: build
  image: bun:latest
  script:
    - bun install 
    - bun run ui:install  # Install dependencies again
    - bun run ui:build    # Build the Vite + React app
    - bun run build        # Final build command, if necessary
    - echo "Successfully built the application"  # Placeholder message
  only:
    - main
